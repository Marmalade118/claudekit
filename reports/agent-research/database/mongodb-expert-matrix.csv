Category,Symptom/Error,Root Cause,Fix 1,Fix 2,Fix 3,Diagnostic Command,Validation Step,Official Link
Document Modeling,Large document size warnings,Embedding too much data in single document,Move large arrays to separate collections,Use document references instead of embedding,Implement data archiving strategy,db.collection.stats(),Check average document size < 16MB,https://docs.mongodb.com/manual/core/data-model-design/
Document Modeling,Poor query performance on related data,Inefficient embedding vs referencing decisions,Analyze query patterns and optimize schema,Implement proper indexing on reference fields,Use aggregation pipeline with $lookup,db.collection.find().explain(),Verify index usage in query plans,https://docs.mongodb.com/manual/core/data-model-operations/
Document Modeling,Unbounded array growth,Storing arrays on the 'one' side of relationships,Move references to the 'many' side,Implement array size limits,Use separate collections for large arrays,db.collection.findOne() to inspect arrays,Monitor array sizes in documents,https://docs.mongodb.com/manual/tutorial/model-referenced-one-to-many-relationships-between-documents/
Aggregation Pipeline,Slow aggregation performance,Pipeline not utilizing indexes effectively,Add $match stages early in pipeline,Create compound indexes for sort operations,Enable allowDiskUse for large datasets,db.collection.aggregate().explain(),Check for IXSCAN in execution stats,https://docs.mongodb.com/manual/aggregation/aggregation-pipeline-optimization/
Aggregation Pipeline,$group not pushed down to shards,Group key not based on shard key,Modify grouping to include shard key,Restructure pipeline for pushdown optimization,Use compound shard key in grouping,db.collection.aggregate().explain(),Verify group pushdown in explain output,https://docs.mongodb.com/manual/core/aggregation-pipeline-sharded-collections/
Aggregation Pipeline,Memory exceeded error,Aggregation pipeline exceeds memory limit,Add { allowDiskUse: true } option,Optimize pipeline with early filtering,Break complex aggregations into stages,Monitor memory usage during execution,Check that allowDiskUse is enabled,https://docs.mongodb.com/manual/core/aggregation-pipeline-limits/
Indexing,COLLSCAN in explain output,Query not using available indexes,Create appropriate single-field index,Design compound index for query pattern,Reorder compound index fields (ESR rule),db.collection.find().explain('executionStats'),Verify IXSCAN instead of COLLSCAN,https://docs.mongodb.com/manual/indexes/
Indexing,High totalDocsExamined ratio,Index selectivity too low,Create more selective compound index,Add partial index with filter expression,Reorder index fields for better selectivity,Compare totalDocsExamined vs totalDocsReturned,Aim for 1:1 ratio of examined to returned,https://docs.mongodb.com/manual/tutorial/analyze-query-plan/
Indexing,Index not used for sort,Sort field not properly indexed,Create index matching sort order,Add sort fields to compound index,Use hint() to force index usage,db.collection.find().sort().explain(),Verify no in-memory sort in plan,https://docs.mongodb.com/manual/tutorial/sort-results-with-indexes/
Performance,Query timeout errors,Query execution time exceeds timeout,Optimize query with proper indexing,Increase maxTimeMS for complex queries,Implement query result pagination,Set maxTimeMS and monitor execution,Ensure queries complete within timeout,https://docs.mongodb.com/manual/reference/method/cursor.maxTimeMS/
Performance,High memory usage,Working set exceeds available RAM,Add more RAM or scale horizontally,Optimize queries to reduce working set,Implement data archiving strategy,db.serverStatus().mem,Monitor resident memory usage,https://docs.mongodb.com/manual/administration/analyzing-mongodb-performance/
Performance,Slow write operations,Too many indexes or large documents,Remove unused indexes,Optimize document structure,Use bulk write operations,db.collection.getIndexes() and profiler,Profile slow operations > 100ms,https://docs.mongodb.com/manual/tutorial/manage-the-database-profiler/
Connection Pool,Connection pool exhausted,Insufficient pool size configuration,Increase maxPoolSize setting,Implement connection retry logic,Optimize query patterns to reduce hold time,Monitor connection pool metrics,Check pool utilization vs limits,https://docs.mongodb.com/drivers/node/current/fundamentals/connection/connection-pools/
Connection Pool,Connection timeout errors,Network latency or pool configuration,Increase connectTimeoutMS setting,Configure retry logic with exponential backoff,Optimize network infrastructure,Test connection with ping,Verify connectivity to all replica members,https://docs.mongodb.com/drivers/node/current/fundamentals/connection/connection-troubleshooting/
Connection Pool,Frequent connection cycling,Improper pool lifecycle management,Adjust maxIdleTimeMS setting,Implement proper connection handling,Monitor connection creation/destruction patterns,Use connection pool monitoring events,Track connection lifecycle metrics,https://docs.mongodb.com/drivers/node/current/fundamentals/connection/connection-monitoring/
Replica Set,Primary election delays,Network partitions or configuration issues,Review replica set configuration,Adjust election timeout settings,Ensure proper network connectivity,rs.status() and rs.conf(),Verify all members are healthy,https://docs.mongodb.com/manual/core/replica-set-elections/
Replica Set,Read preference not working,Incorrect read preference configuration,Configure appropriate read preference,Use read preference tags,Implement read preference in connection string,Test read routing to secondaries,Verify reads are distributed as expected,https://docs.mongodb.com/manual/core/read-preference/
Replica Set,High replica lag,Secondary members falling behind primary,Scale secondary hardware resources,Optimize oplog size,Reduce write load on primary,rs.printReplicationInfo(),Monitor oplog window and lag metrics,https://docs.mongodb.com/manual/tutorial/troubleshoot-replica-sets/
Sharding,Uneven shard distribution,Poor shard key selection,Choose higher cardinality shard key,Implement compound shard key,Use hashed sharding for better distribution,sh.status() and sh.getBalancerState(),Monitor chunk distribution across shards,https://docs.mongodb.com/manual/core/sharding-shard-key/
Sharding,Scatter-gather queries,Queries not targeting specific shards,Include shard key in query predicates,Design queries to target single shards,Implement application-level routing,Use db.collection.explain() on sharded cluster,Minimize shards accessed per query,https://docs.mongodb.com/manual/core/sharded-cluster-query-router/
Sharding,Balancer not running,Balancer configuration or network issues,Enable balancer with sh.enableBalancing(),Configure balancer window,Resolve network connectivity issues,sh.getBalancerState(),Verify balancer is active and migrating,https://docs.mongodb.com/manual/tutorial/manage-sharded-cluster-balancer/
Transactions,Transaction timeout errors,Long-running transactions or deadlocks,Reduce transaction scope and duration,Implement proper retry logic,Use read/write concerns appropriately,Monitor transaction metrics,Ensure transactions complete quickly,https://docs.mongodb.com/manual/core/transactions/
Transactions,Write concern timeout,Insufficient replica acknowledgment,Adjust write concern settings,Ensure replica set health,Optimize network between replicas,Use appropriate write concern level,Verify replica acknowledgment,https://docs.mongodb.com/manual/reference/write-concern/
Transactions,TransientTransactionError,Network issues or resource conflicts,Implement transaction retry logic,Use exponential backoff for retries,Handle specific error codes appropriately,Monitor transaction error rates,Track retry success rates,https://docs.mongodb.com/manual/core/transactions-in-applications/
Schema Validation,Document validation failures,Schema constraints not met,Adjust validation rules,Implement proper error handling,Use JSON Schema validation,db.runCommand({collMod: 'collection'}),Test validation rules with sample data,https://docs.mongodb.com/manual/core/schema-validation/
Schema Validation,Type casting errors,Data type mismatches in schema,Align data types in application,Implement data transformation,Use Mongoose type casting,Validate data before insert/update,Ensure type compatibility,https://mongoosejs.com/docs/schematypes.html
Schema Validation,Required field violations,Missing mandatory fields in documents,Add required field validation,Implement default values,Use pre-save middleware for validation,Check document structure before save,Verify all required fields are present,https://mongoosejs.com/docs/validation.html
GridFS,GridFS performance issues,Large file storage inefficiency,Implement file chunking optimization,Use appropriate chunk size,Consider alternative storage solutions,Monitor GridFS collection metrics,Test file upload/download performance,https://docs.mongodb.com/manual/core/gridfs/
GridFS,File corruption in GridFS,Incomplete file uploads or storage errors,Implement file integrity checking,Use proper error handling during uploads,Verify file checksums,Compare file checksums before/after,Ensure file integrity end-to-end,https://docs.mongodb.com/manual/core/gridfs/
Text Search,Poor text search relevance,Inadequate text index configuration,Configure text index weights,Use compound text indexes,Implement custom scoring,db.collection.find({$text: {$search: 'term'}}).explain(),Test search relevance with sample queries,https://docs.mongodb.com/manual/core/index-text/
Text Search,Text search performance issues,Text index not optimized for queries,Create compound indexes with text,Limit search result size,Use text search with additional filters,Monitor text search execution time,Optimize search query patterns,https://docs.mongodb.com/manual/tutorial/text-search-in-aggregation/
Security,Authentication failures,Incorrect user credentials or configuration,Verify user credentials and roles,Update authentication mechanisms,Configure proper user permissions,db.runCommand({connectionStatus: 1}),Test user authentication and authorization,https://docs.mongodb.com/manual/core/authentication/
Security,Authorization errors,Insufficient user privileges,Grant appropriate roles to users,Create custom roles if needed,Review role-based access control,db.runCommand({usersInfo: 1}),Verify user permissions match requirements,https://docs.mongodb.com/manual/core/authorization/
Monitoring,Missing performance metrics,Inadequate monitoring setup,Configure database profiler,Implement application-level monitoring,Use MongoDB monitoring tools,db.setProfilingLevel(1),Monitor slow operations and resource usage,https://docs.mongodb.com/manual/administration/monitoring/
Monitoring,Alert fatigue from monitoring,Too many false positive alerts,Tune alert thresholds,Implement alert prioritization,Use trend-based alerting,Review monitoring metrics regularly,Ensure alerts are actionable and relevant,https://docs.mongodb.com/manual/administration/production-notes/